--조인
-- 여러개의 테이블에서 필요한 데이터를 조회하기위해
-- 테이블 결합해서 조회하기 위한 연산.
-- 조인을 할려면 테이블 끼리 연결 될 수있는 동일한 데이터를 가지고 있는 컬럼이 있어야됨
CREATE TABLE A(
	CODE CHAR(1),
	VAL NUMBER(1)
);
CREATE TABLE B(
	CODE CHAR(1),
	UNIT CHAR(1)
);
INSERT INTO A VALUES('A',1);
INSERT INTO A VALUES('B',2);
INSERT INTO A VALUES('C',3);
INSERT INTO A VALUES('D',4);

INSERT INTO B VALUES('A','+');
INSERT INTO B VALUES('B','-');
INSERT INTO B VALUES('C','*');
INSERT INTO B VALUES('F','/');

SELECT * FROM A;
SELECT * FROM B;

--동일 조인
-- 같은 값을 기준으로 결합
SELECT A.CODE, A.VAL, B.CODE, B.UNIT 
FROM A, B
WHERE A.CODE = B.CODE; 

--INNER JOIN
--   조인 조건을 만족하는 모든 행을 결합
SELECT A.CODE, A.VAL, B.CODE, B.UNIT 
FROM A INNER JOIN B ON A.CODE <> B.CODE;

SELECT A.CODE, A.VAL, B.CODE, B.UNIT 
FROM A JOIN B ON A.CODE = B.CODE;

--자연조인(NATURAL JOIN)
--자동으로 똑같은 컬럼을 찾아서 조인하고 중복된 컬럼을 제거해서 조회
SELECT * FROM A NATURAL JOIN B;

--교차 조인(CROSS JOIN)
--두 테이블의 모든 조합을 조회
SELECT * FROM A CROSS JOIN B;

--학생 테이블에 학과명만 중복없이 조회
SELECT DISTINCT STD_MAJOR FROM STUDENT;
--학과명, 행번호
SELECT 
	TO_CHAR(ROWNUM,'FM00') AS MAJOR_NO, 
	STD_MAJOR AS MAJOR_NAME 
FROM (SELECT DISTINCT STD_MAJOR FROM STUDENT);
--학과 테이블 생성
CREATE TABLE MAJOR
AS
SELECT 
	TO_CHAR(ROWNUM,'FM00') AS MAJOR_NO, 
	STD_MAJOR AS MAJOR_NAME 
FROM (SELECT DISTINCT STD_MAJOR FROM STUDENT);
--학생 테이블에 학과 번호 컬럼을 추가
ALTER TABLE STUDENT ADD MAJOR_NO VARCHAR2(3);
--학생 테이블에 학과 번호 업데이트
UPDATE STUDENT
SET MAJOR_NO = 
	(SELECT MAJOR_NO FROM MAJOR WHERE MAJOR_NAME = STD_MAJOR);

SELECT * FROM STUDENT;
--학생 테이블에서 학과명 컬럼 삭제
ALTER TABLE STUDENT DROP COLUMN STD_MAJOR;

--학생 정보 조회시
--학번 이름 학과명 평점 조회
SELECT S.STD_NO, S.STD_NAME, M.MAJOR_NAME, S.STD_SCORE
FROM STUDENT S JOIN MAJOR M ON S.MAJOR_NO = M.MAJOR_NO;

SELECT * FROM STUDENT NATURAL JOIN MAJOR;

--제품 정보 조회시 
-- 제품번호, 제품명, 제조사명, 금액
SELECT 
	P.PRODUCT_ID, P.PRODUCT_NAME, M.MANUFACTURER_NAME,
	P.PRICE 
FROM PRODUCT P JOIN MANUFACTURER M 
ON P.MANUFACTURER_ID = M.MANUFACTURER_ID; 

SELECT 
	P.PRODUCT_ID, P.PRODUCT_NAME, M.MANUFACTURER_NAME,
	P.PRICE 
FROM PRODUCT P , MANUFACTURER M
WHERE P.MANUFACTURER_ID = M.MANUFACTURER_ID; 





